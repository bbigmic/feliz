"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},1386:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>q,patchFetch:()=>v,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>w});var a={};r.r(a),r.d(a,{POST:()=>x});var s=r(9303),i=r(8716),o=r(670),n=r(7070),u=r(3524),p=r(8691),l=r(1482),c=r.n(l);let d=process.env.JWT_SECRET||"tajny_klucz",m=new u.PrismaClient;async function x(e){try{let{email:t,password:r}=await e.json();if(!t||!r)return n.NextResponse.json({error:"Email i hasło są wymagane."},{status:400});let a=await m.user.findUnique({where:{email:t}});if(!a||!await p.ZP.compare(r,a.passwordHash))return n.NextResponse.json({error:"Nieprawidłowy email lub hasło."},{status:401});let s=c().sign({id:a.id,email:a.email},d,{expiresIn:"7d"}),i=n.NextResponse.json({success:!0});return i.cookies.set("token",s,{httpOnly:!0,sameSite:"lax",secure:!0,maxAge:604800,path:"/"}),i}catch(e){return n.NextResponse.json({error:"Błąd serwera."},{status:500})}finally{await m.$disconnect()}}let h=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"/Users/bigmic/Desktop/apki/feliztrade/app/api/auth/login/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:w,serverHooks:f}=h,q="/api/auth/login/route";function v(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:w})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,972,482,691],()=>r(1386));module.exports=a})();