"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},1399:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>j,patchFetch:()=>k,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>w,staticGenerationAsyncStorage:()=>f});var s={};r.r(s),r.d(s,{POST:()=>x});var a=r(9303),i=r(8716),n=r(670),o=r(7070),u=r(3524),p=r(8691),c=r(1482),d=r.n(c);let l=new u.PrismaClient,m=process.env.JWT_SECRET||"tajny_klucz";async function x(e){try{let{email:t,password:r,termsAccepted:s,marketingAccepted:a}=await e.json();if(!t||!r)return o.NextResponse.json({error:"Email i hasło są wymagane."},{status:400});if(await l.user.findUnique({where:{email:t}}))return o.NextResponse.json({error:"Użytkownik o tym adresie email już istnieje."},{status:409});let i=await p.ZP.hash(r,10),n=await l.user.create({data:{email:t,passwordHash:i,termsAccepted:!!s,marketingAccepted:!!a}}),u=d().sign({id:n.id,email:n.email},m,{expiresIn:"7d"}),c=o.NextResponse.json({success:!0});return c.cookies.set("token",u,{httpOnly:!0,sameSite:"lax",secure:!0,maxAge:604800,path:"/"}),c}catch(e){return o.NextResponse.json({error:"Błąd serwera."},{status:500})}finally{await l.$disconnect()}}let h=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/Users/bigmic/Desktop/apki/feliztrade/app/api/auth/register/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:w}=h,j="/api/auth/register/route";function k(){return(0,n.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:f})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972,482,691],()=>r(1399));module.exports=s})();