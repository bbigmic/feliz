"use strict";(()=>{var e={};e.id=426,e.ids=[426],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4901:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>w,patchFetch:()=>h,requestAsyncStorage:()=>p,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var a={};t.r(a),t.d(a,{GET:()=>d});var s=t(9303),n=t(8716),i=t(670),o=t(7070),c=t(3524);async function d(){try{console.log("Refresh DB called - forcing complete refresh");let e=new c.PrismaClient;await e.$connect(),await e.$disconnect();let r=new c.PrismaClient;await r.$connect();let t=await r.order.count(),a=await r.order.findFirst({orderBy:{createdAt:"desc"},select:{id:!0,email:!0,createdAt:!0}}),s=await r.order.findMany({where:{createdAt:{gte:new Date(Date.now()-864e5)}},orderBy:{createdAt:"desc"},select:{id:!0,email:!0,createdAt:!0}}),n=await r.$queryRaw`
      SELECT 
        current_database() as database_name,
        current_user as current_user,
        NOW() as current_time
    `;return await r.$disconnect(),o.NextResponse.json({success:!0,message:"Połączenie z bazą odświeżone",orderCount:t,latestOrder:a,recentOrders:s,connectionInfo:n,timestamp:new Date().toISOString()})}catch(e){return console.error("Refresh DB error:",e),o.NextResponse.json({error:String(e),message:"Błąd odświeżania połączenia"},{status:500})}}let u=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/refresh-db/route",pathname:"/api/refresh-db",filename:"route",bundlePath:"app/api/refresh-db/route"},resolvedPagePath:"/Users/bigmic/Desktop/apki/feliztrade/app/api/refresh-db/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:l,serverHooks:m}=u,w="/api/refresh-db/route";function h(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[276,972],()=>t(4901));module.exports=a})();